---
title: "주식 db 설계"
date: 2021-01-15 14:05:00 -0400
categories: 개발
---

포트 폴리오에 넣는 구입한 주식 DB까지는 설계하는 것이 어렵지 않았다.
각각 테이블의 역할이 명확해서 그런 것 같다.

포트폴리오 통합 관리 서비스에서는 몇가지 생각할 만한 점이 있다.
1) 미국 주식/한국 주식/암호화페를 모두 관리 가능할 수 있어야 함.
2) 현재 가격을 받아 수익률을 표시하여야 함.
3) 주식 정보와 현재가는 기존에 존재하는 정보이고 지속적으로 대량 업데이트가 필요하다.

헷갈려서 정규화를 다시 검색했다.
데이터베이스의 정규화
1정규화 - 한 컬럼에는 한개의 값만 담아
2정규화 - (ex 기본키가 두개있을때)
기본키 하나에만 필요한 정보가 있으면 중복이 일어난다.
3정규화 - 기본키만이다른 컬럼들을 지배 할 수 있다.
다른 컬럼(ex 우편번호)가 그 이외의 컬럼(ex. 거주하는 시/군)을 정하면 안된다.

일단 요약하여 놓고 읽으면서 비교

주식(id/기업명/티커/현재가격/분류항목)에서
분류항목은 직접해야 할 수 있으므로 배제
현재가격의 경우 내 생각으로는 정규화에 문제 없어 보인다.

포트폴리오의 경우에는
주식의 현재가격/주식의 구입가격 = 주식 단일 수익률
포트폴리오 수익률 = 전체 주식의 현재가 합 / 전체 주식의 구입가 합 = 포폴 수익률
그러면 각 주식마다 외부로 api요청을 해야하는 점이 있다.

외부 api 처리나 내부 api 처리나 결국
똑같이 api를 호출하는 것이기 떄문에 직접 db 업데이트를 하기로 결정했다.
물론 네이버 서버가 훨씬 안정적이겠지만
현재가격은 일별로 업데이트를 하기로 하고 문제가 생기면 리팩토링을 하려고 한다.
